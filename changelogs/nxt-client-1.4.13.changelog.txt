Peer networking improvements, better logging, bugfixes.

